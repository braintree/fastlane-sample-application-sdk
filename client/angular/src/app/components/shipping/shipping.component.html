<section id="shipping" [ngClass]="{ active: isActive, visited: visited || isAuthenticated }">
  <div class="header">
    <h2>Shipping</h2>
    <button (click)="onEditButtonClick()" id="shipping-edit-button" type="button" class="edit-button">
      <span class="button-icon"></span>
      Edit
    </button>
  </div>
  <div class="summary">
    <ng-container *ngIf="shippingAddressData">
      <div [innerHTML]="getAddressSummary"></div>
    </ng-container>
  </div>
  <form [formGroup]="shippingForm" #shippingFormElement style="padding: 0">
    <fieldset>
      <span>
        <input required id="shipping-required-checkbox" [formControl]="shippingRequired" name="shipping-required" type="checkbox"
          checked />
        <label for="shipping-required-checkbox" class="checkbox-label">
          This purchase requires shipping
        </label>
      </span>
      <div class="form-row">
        <div class="form-group">
          <input required maxlength="255"
            [ngClass]="{'input-invalid': shippingForm.get('firstName')?.invalid && shippingFormInvalid }"
            formControlName="firstName" id="given-name" name="given-name" autocomplete="given-name"
            placeholder="First Name" />
          <label for="given-name" class="label">First Name</label>
        </div>
        <div class="form-group">
          <input required maxlength="255"
            [ngClass]="{'input-invalid': shippingForm.get('lastName')?.invalid && shippingFormInvalid }"
            formControlName="lastName" id="family-name" name="family-name" autocomplete="family-name"
            placeholder="Last Name" />
          <label for="family-name" class="label">Last Name</label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <input maxlength="255" formControlName="company" id="company" name="company" autocomplete="organization"
            placeholder="Company name (optional)" />
          <label for="company" class="label">Company name (optional)</label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <input required maxlength="255"
            [ngClass]="{'input-invalid': shippingForm.get('streetAddress')?.invalid && shippingFormInvalid }"
            formControlName="streetAddress" id="address-line1" name="address-line1" autocomplete="address-line1"
            placeholder="Address Line 1" />
          <label for="address-line1" class="label">Address Line 1</label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <input maxlength="255" formControlName="extendedAddress" id="address-line2" name="address-line2"
            autocomplete="address-line2" placeholder="Apt., ste., bldg. (optional)" />
          <label for="address-line2" class="label">
            Apt., ste, bldg. (optional)
          </label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <input required maxlength="255"
            [ngClass]="{'input-invalid': shippingForm.get('locality')?.invalid && shippingFormInvalid }"
            formControlName="locality" id="address-level2" name="address-level2" autocomplete="address-level2"
            placeholder="City" />
          <label for="address-level2" class="label">City</label>
        </div>

        <div class="form-group">
          <input required maxlength="255"
            [ngClass]="{'input-invalid': shippingForm.get('region')?.invalid && shippingFormInvalid }"
            formControlName="region" id="address-level1" name="address-level1" autocomplete="address-level1"
            placeholder="State" />
          <label for="address-level1" class="label">State</label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <input required pattern="\d{5}(-\d{4})?"
            title="The ZIP code must have the one of the following formats: 12345 or 12345-6789"
            [ngClass]="{'input-invalid': shippingForm.get('postalCode')?.invalid && shippingFormInvalid }"
            formControlName="postalCode" id="postal-code" name="postal-code" autocomplete="postal-code"
            placeholder="ZIP Code" />
          <label for="postal-code" class="label">ZIP Code</label>
        </div>
        <div class="form-group">
          <input required pattern="US" minlength="2" maxlength="2" title="Currently only available to the US"
            [ngClass]="{'input-invalid': shippingForm.get('countryCodeAlpha2')?.invalid && shippingFormInvalid }"
            formControlName="countryCodeAlpha2" id="country" name="country" autocomplete="country"
            placeholder="Country (eg. US, UK)" />
          <label for="country" class="label">Country (eg. US, UK)</label>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <input 
            pattern="([0-9]{1,3})?" 
            title="Please enter a valid country calling code with 1 to 3 digits"
            minlength="1" maxlength="3"
            [ngClass]="{'input-invalid': shippingForm.get('phoneCountryCode')?.invalid && shippingFormInvalid }"
            formControlName="phoneCountryCode" id="tel-country-code" name="tel-country-code"
            autocomplete="tel-country-code" placeholder="Country calling code" />
          <label for="tel-country-code" class="label">
            Country calling code
          </label>
        </div>

        <div class="form-group">
          <input 
            pattern="([0-9]{10})?"
            title="Please enter a valid US phone number like (123) 456-7890, type only numbers"
            [ngClass]="{'input-invalid': shippingForm.get('phoneNumber')?.invalid && shippingFormInvalid }"
            formControlName="phoneNumber"
            id="tel-national" name="tel-national" type="tel" autocomplete="tel-national" placeholder="Phone Number" />
          <label for="tel-national" class="label">Phone Number</label>
        </div>
      </div>
    </fieldset>
    <button (click)="onContinueButtonClick()" id="shipping-submit-button" type="button" class="submit-button">
      Confirm
    </button>
  </form>
</section>